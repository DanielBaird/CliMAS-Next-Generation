!function t(i,e,s){function a(o,l){if(!e[o]){if(!i[o]){var r="function"==typeof require&&require;if(!l&&r)return r(o,!0);if(n)return n(o,!0);throw new Error("Cannot find module '"+o+"'")}var p=e[o]={exports:{}};i[o][0].call(p.exports,function(t){var e=i[o][1][t];return a(e?e:t)},p,p.exports,t,i,e,s)}return e[o].exports}for(var n="function"==typeof require&&require,o=0;o<s.length;o++)a(s[o]);return a}({1:[function(t){t("./mapview/main"),t("./menusandpanels"),$(function(){$("nav > ul").mspp({})})},{"./mapview/main":2,"./menusandpanels":5}],2:[function(t){var i;window.console||(window.console={log:function(){return{}}}),i=t("./views/app"),$(function(){var t;return t=new i,t.render()})},{"./views/app":4}],3:[function(t,i){var e;e=Backbone.Model.extend({constructor:function(t,i,e){return this.shortName=t,this.longName=i,this.path=e,null}}),i.exports=e},{}],4:[function(t,i){var e,s;s=t("../models/maplayer"),e=Backbone.View.extend({tagName:"div",className:"splitmap",id:"splitmap",trackSplitter:!1,trackPeriod:100,events:{"click #btn-change":"toggleForms","click #btn-compare":"toggleSplitter"},initialize:function(){return this.mapLayer=new s("left","Left Map","left.map"),_.bindAll(this),this.speciesInfoFetchProcess=this.fetchSpeciesInfo()},render:function(){return this.$el.append(e.templates.layout({leftTag:e.templates.leftTag(),rightTag:e.templates.rightTag(),leftForm:e.templates.leftForm()})),$("#contentwrap").append(this.$el),this.map=L.map("map",{center:[-20,136],zoom:5}),L.tileLayer("http://otile1.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.png",{maxZoom:18}).addTo(this.map),this.leftForm=this.$el.find(".left.form"),this.buildLeftForm(),this.leftTag=this.$el.find(".left.tag"),this.rightTag=this.$el.find(".right.tag"),this.splitLine=this.$el.find(".splitline"),this.splitThumb=this.$el.find(".splitthumb")},centreMap:function(t){var i,e,s;for(t||(t=500),s=[],i=e=0;t>=e;i=e+=25)s.push(setTimeout(function(t){return function(){return t.map.invalidateSize(!1)}}(this),i));return s},toggleForms:function(){return this.$el.toggleClass("showforms"),this.centreMap()},toggleSplitter:function(){return this.$el.toggleClass("split"),this.$el.hasClass("split")?this.activateSplitter():this.deactivateSplitter(),this.centreMap()},fetchSpeciesInfo:function(){return $.ajax({url:"/data/species"}).done(function(t){return function(i){var e,s;return e=[],s=[],$.each(i,function(t,i){return s.push(t),i?$.each(i,function(i,s){return e.push({label:s+" ("+t+")",value:t})}):e.push({label:t,value:t})}),t.speciesLookupList=e,t.speciesSciNameList=s}}(this))},buildLeftForm:function(){return this.speciesInfoFetchProcess.done(function(t){return function(){return t.$el.find("#leftmapthing").autocomplete({source:t.speciesLookupList})}}(this))},startSplitterTracking:function(){return this.trackSplitter=!0,this.splitLine.addClass("dragging"),this.locateSplitter()},locateSplitter:function(){return this.trackSplitter?(this.resizeThings(),0===this.trackSplitter?this.trackSplitter=!1:this.trackSplitter!==!0&&(this.trackSplitter-=1),setTimeout(this.locateSplitter,this.trackPeriod)):void 0},stopSplitterTracking:function(){return this.splitLine.removeClass("dragging"),this.trackSplitter=5},activateSplitter:function(){return this.splitThumb.draggable({containment:$("#mapwrapper"),scroll:!1,start:this.startSplitterTracking,drag:this.resizeThings,stop:this.stopSplitterTracking}),this.resizeThings()},deactivateSplitter:function(){return this.splitThumb.draggable("destroy"),this.resizeThings()},resizeThings:function(){var t;return this.$el.hasClass("split")?(t=this.splitThumb.position().left+this.splitThumb.width()/2,this.splitLine.css("left",t),this.leftTag.css("clip","rect(0 "+t+"px auto 0)")):this.leftTag.css("clip","rect(auto auto auto auto)")}},{templates:{layout:_.template('<div class="splitline"></div>\n<div class="splitthumb"><span>&#x276e; &#x276f;</span></div>\n<div class="left tag"><%= leftTag %></div>\n<div class="right tag"><%= rightTag %></div>\n<div class="left form"></div>\n<div class="right form"></div>\n<div id="mapwrapper"><div id="map"></div></div>'),leftTag:_.template('<div>\n    <input id="leftmapthing" name="leftmapthing" placeholder="&hellip; start typing species or group name &hellip;" />\n    <button id="btn-change">change</button>\n    <button id="btn-compare">compare</button>\n</div>'),rightTag:_.template('<div>\n    <input id="rightmapthing" name="rightmapthing" placeholder="&hellip; start typing species or group name &hellip;" />\n</div>'),leftForm:_.template("")}}),i.exports=e},{"../models/maplayer":3}],5:[function(){!function(t){t.widget("climas.mspp",{options:{animationFactor:2,mainMenuClass:"mspp-main-menu",panelClass:"mspp-panel",pageClass:"mspp-page",clearfixClass:"mspp-clearfix",activeClass:"current"},_create:function(){var i=this,e=this.options,s=this.element;this.mainMenuItems=s.children("li"),this.panels=t("."+e.panelClass),s.css({opacity:0}),this.panels.css({opacity:0}),s.addClass(e.mainMenuClass),s.addClass(e.clearfixClass),this.panels.addClass(e.clearfixClass),this._layoutMenu(),this._layoutPanels(),s.on("msppshowmenu",this._showMenu),s.on("msppshowsubmenu",this._showSubMenu),s.on("msppshowpanel",this._showPanel),s.on("msppshowpage",this._showPage),this.mainMenuItems.each(function(e,s){t(s).children("a").click(function(t){i._trigger("showmenu",t,{menuitem:s,widget:i})}),t(s).find("li").each(function(e,a){t(a).find("a").click(function(t){i._trigger("showsubmenu",t,{menuitem:s,submenuitem:a,widget:i})})})}),s.find("[data-targetpanel]").each(function(e,s){var a=t(s);a.click(function(e){i._trigger("showpanel",e,{panel:t("#"+a.data("targetpanel")).first(),widget:i})})}),this.panels.each(function(e,s){var a=t(s);a.find("[data-targetpage]").click(function(e){i._trigger("showpage",e,{panel:a,page:t("#"+t(this).data("targetpage")),widget:i})})});var a=this.mainMenuItems.filter("."+e.activeClass);a.removeClass(e.activeClass).children("a").click(),s.animate({opacity:1},"fast")},_switchClassOption:function(t,i){var e=this.options[t];if(e!==i){var s=this.element.find("."+e);this.options[t]=i,s.removeClass(e),s.addClass(i)}},_setOption:function(t,i){switch(t){case"mainMenuClass":case"clearfixClass":case"activeClass":this._switchClassOption(t,i);break;default:this.options[t]=i}this._super("_setOption",t,i)},_destroy:function(){this.element.removeClass(this.options.mainMenuClass),this.element.removeClass(this.options.clearfixClass),this.panels.removeClass(this.options.clearfixClass)},_layoutMenu:function(){this.element.find("ul").each(function(i,e){var s=t(e);s.css({width:"auto"}),s.data("originalWidth",s.width()),s.css({width:0,display:"none"})})},_showMenu:function(i,e){var s=t(e.menuitem),a=e.widget;if(s.hasClass(a.options.activeClass));else{a._hidePanels(),a.mainMenuItems.removeClass(a.options.activeClass);var n=s.find("ul"),o=a.element.find("ul").not(n),l=n.data("originalWidth");o.animate({width:0},50*a.options.animationFactor,function(){o.css({display:"none"})}),s.addClass(a.options.activeClass),n.css({display:"block"}).animate({width:l},125*a.options.animationFactor,function(){n.css({width:"auto"}).removeAttr("style"),a._trigger("menushown",i,{item:s,widget:a})}),n.find("."+a.options.activeClass+" a").click()}},_showSubMenu:function(i,e){t(e.menuitem).find("li").removeClass(e.widget.options.activeClass),t(e.submenuitem).addClass(e.widget.options.activeClass)},_layoutPanels:function(){var i=this.panels.find("."+this.options.pageClass);i.each(function(i,e){var s=t(e);s.css({height:"auto"}),s.data("originalHeight",s.outerHeight()),s.css({height:0,display:"none"})}),this.panels.each(function(i,e){var s=t(e);s.css({display:"none"})})},_hidePanels:function(){this.panels.removeClass(this.options.activeClass).css({display:"none",height:0})},_showPanel:function(i,e){var s=t(e.panel),a=e.widget;if(s.hasClass(a.options.activeClass));else{a._hidePanels(),s.addClass(a.options.activeClass),s.css({display:"block",opacity:1});var n=t(s.find("."+a.options.pageClass+"."+a.options.activeClass));a._trigger("showpage",i,{panel:s,page:n,widget:a})}},_showPage:function(i,e){var s=e.widget,a=t(e.panel),n=t(e.page),o=n.data("originalHeight");a.css({height:a.height()});var l=a.find("."+s.options.pageClass+"."+s.options.activeClass).not(n);l.length>0&&(l.data("originalHeight",l.outerHeight()),l.removeClass(s.options.activeClass).fadeOut(50*s.options.animationFactor,function(){l.css({height:0})})),n.css({height:"auto"}).addClass(s.options.activeClass).fadeIn(100*s.options.animationFactor,function(){n.removeAttr("style")});var r=l.length>0?100*s.options.animationFactor:150*s.options.animationFactor;a.animate({height:o},r,function(){a.removeAttr("style")})},_:null})}(jQuery,window,document)},{}]},{},[1]);